!function a(i,c,u){function s(t,e){if(!c[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var n=c[t]={exports:{}};i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,a,i,c,u)}return c[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cache=void 0;r.cache={}},{}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hooks=void 0;r.hooks={}},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cache",{enumerable:!0,get:function(){return o.cache}}),Object.defineProperty(r,"hooks",{enumerable:!0,get:function(){return n.hooks}}),Object.defineProperty(r,"Model",{enumerable:!0,get:function(){return a.Model}}),Object.defineProperty(r,"persist",{enumerable:!0,get:function(){return i.persist}});var o=e("./cache"),n=e("./hooks"),a=e("./model"),i=e("./persist")},{"./cache":1,"./hooks":2,"./model":4,"./persist":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Model=void 0;var f=e(".");function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(){function t(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!e.id)throw new Error("Model.js: cannot create instance without an id!");Object.assign(this,e);var u=this.constructor.prototype.modelName||this.constructor.name,s=this.id;return f.cache[u]||(f.cache[u]={}),f.hooks[u]||(f.hooks[u]={}),f.hooks[u][s]={onbeforedelete:[],onbeforeupdate:[]},new Proxy(this,{get:function(e,t,r){return Reflect.get(e,t,r)},set:function(e,t,r){var o=!0,n=!1,a=void 0;try{for(var i,c=f.hooks[u][s].onbeforeupdate[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){(0,i.value)(t,e[t],r)}}catch(e){n=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(n)throw a}}return Reflect.set(e,t,r),!0}})}return function(e,t,r){t&&o(e.prototype,t),r&&o(e,r)}(t,[{key:"_cache",value:function(){var e=(new Date).toISOString(),t=this._cached();return t?(t.instance=this,t.updated=e):(t={created:e,instance:this},f.cache[this._modelName()][this.id]=t),t}},{key:"_cached",value:function(){return f.cache[this._modelName()][this.id]}},{key:"_hook",value:function(e,t){f.hooks[this._modelName()][this.id][e].push(t)}},{key:"_id",value:function(){return this._modelName()+"-"+this.id}},{key:"_modelName",value:function(){return this.constructor.prototype.modelName||this.constructor.name}},{key:"delete",value:function(){var e=this.id,t=this._modelName(),r=f.hooks[t][e].onbeforedelete;if(r.length){var o=!0,n=!1,a=void 0;try{for(var i,c=r[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){(0,i.value)()}}catch(e){n=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(n)throw a}}}delete f.cache[t][e],delete f.hooks[t][e],f.persist&&localStorage.removeItem(this._id())}},{key:"onbeforedelete",value:function(e){this._hook("onbeforedelete",e)}},{key:"onbeforeupdate",value:function(e){this._hook("onbeforeupdate",e)}},{key:"save",value:function(){this._cache(),f.persist&&localStorage.setItem(this._id(),JSON.stringify(this))}}],[{key:"cache",value:function(){return f.cache[this._modelName()]}},{key:"deleteCache",value:function(){f.cache[this._modelName()]={}}},{key:"first",value:function(e){return this.get(e)[0]}},{key:"get",value:function(e){return e?"string"==typeof e?this._getById(e):e instanceof Array?this._getByIds(e):e instanceof Object?this._getByProperties(e):void 0:this._getInstances()}},{key:"preload",value:function(e){var t=this._modelName(),r=t.length;if(!e||e.localStorage)for(var o=localStorage.length,n=0;n<o;n++){var a=localStorage.key(n);a.slice(0,r)===t&&new this(JSON.parse(localStorage.getItem(a)))._cache()}}},{key:"_getById",value:function(e){var t=this._modelName(),r=f.cache[t][e];if(r)return r.instance;if(f.persist){var o=JSON.parse(localStorage.getItem(t+"-"+e));if(o&&o.id)return new this(o)}return null}},{key:"_getByIds",value:function(e){var t=[],r=this._modelName();for(var o in f.cache[r]){var n=f.cache[r][o].instance,a=!0,i=!1,c=void 0;try{for(var u,s=e[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value;if(n.id===l){t.push(n);break}}}catch(e){i=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw c}}}return t}},{key:"_getByProperties",value:function(e){var t=[],r=f.cache[this._modelName()];for(var o in r){var n=r[o].instance,a=!0;for(var i in e)if(n[i]!==e[i]){a=!1;break}a&&t.push(n)}return t}},{key:"_getInstances",value:function(){var e=[],t=f.cache[this._modelName()];for(var r in t)e.push(t[r].instance);return e}},{key:"_modelName",value:function(){return this.prototype.modelName||this.prototype.constructor.name}}]),t}();r.Model=n},{".":3}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=!(r.default=void 0);try{localStorage.setItem("tdmnco-model-js",{}),localStorage.removeItem("tdmnco-model-js")}catch(e){console.warn("Model.js: localStorage not supported!",e),o=!1}var n=o;r.default=n},{}]},{},[3]);