{"version":3,"sources":["model.js","index.js"],"names":["cache","persist","localStorage","setItem","removeItem","error","console","warn","Model","data","_created","Date","toISOString","_data","_updateHooks","key","Object","defineProperty","get","set","value","hook","keys","push","id","modelName","constructor","name","JSON","stringify","prototype","instance","parse","getItem"],"mappings":";;;;;;;;;;;AAAA;AACA,IAAIA,QAAQ,EAAZ;AACA,IAAIC,UAAU,IAAd;kBCDSO;ADGT,IAAI;AACFN,eAAaC,OAAb,CAAqB,iBAArB,EAAwC,EAAxC;AACAD,eAAaE,UAAb,CAAwB,iBAAxB;AACD,CAHD,CAGE,OAAMC,KAAN,EAAa;AACbC,UAAQC,IAAR,CAAa,uCAAb,EAAsDF,KAAtD;;AAEAJ,YAAU,KAAV;AACD;;AAED;;IACMO;AACJ,iBAAYC,IAAZ,EAAkB;AAAA;;AAAA;;AAChB,SAAKC,QAAL,GAAgB,IAAIC,IAAJ,GAAWC,WAAX,EAAhB;AACA,SAAKC,KAAL,GAAaJ,IAAb;AACA,SAAKK,YAAL,GAAoB,EAApB;;AAHgB,+BAKPC,GALO;AAMdC,aAAOC,cAAP,CAAsB,KAAtB,EAA4BF,GAA5B,EAAiC;AAC/BG,aAAK,eAAM;AACT,iBAAO,MAAKL,KAAL,CAAWE,GAAX,CAAP;AACD,SAH8B;;AAK/BI,aAAK,aAACC,KAAD,EAAW;AAAA;AAAA;AAAA;;AAAA;AACd,kCAAiB,MAAKN,YAAtB,mIAAoC;AAAA,kBAA3BO,IAA2B;;AAClCA,mBAAKN,GAAL,EAAU,MAAKF,KAAL,CAAWE,GAAX,CAAV,EAA2BK,KAA3B;AACD;AAHa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKd,gBAAKP,KAAL,CAAWE,GAAX,IAAkBK,KAAlB;;AAEA,iBAAOA,KAAP;AACD;AAb8B,OAAjC;AANc;;AAAA;AAAA;AAAA;;AAAA;AAKhB,2BAAgBJ,OAAOM,IAAP,CAAY,KAAKT,KAAjB,CAAhB,8HAAyC;AAAA,YAAhCE,GAAgC;;AAAA,cAAhCA,GAAgC;AAgBxC;AArBe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsBjB;;;;6BAcQM,MAAM;AACb,WAAKP,YAAL,CAAkBS,IAAlB,CAAuBF,IAAvB;AACD;;;2BAEM;AACL,UAAIG,KAAK,CAAC,KAAKC,SAAL,IAAkB,KAAKC,WAAL,CAAiBC,IAApC,IAA4C,GAA5C,GAAkD,KAAKH,EAAhE;;AAEAxB,YAAMwB,EAAN,IAAY,IAAZ;;AAEA,UAAIvB,OAAJ,EAAa;AACXC,qBAAaC,OAAb,CAAqBqB,EAArB,EAAyBI,KAAKC,SAAL,CAAe,KAAKhB,KAApB,CAAzB;AACD;AACF;;;wBAxBUW,IAAI;AACbA,WAAK,CAAC,KAAKM,SAAL,CAAeL,SAAf,IAA4B,KAAKK,SAAL,CAAeJ,WAAf,CAA2BC,IAAxD,IAAgE,GAAhE,GAAsEH,EAA3E;;AAEA,UAAIO,WAAW/B,MAAMwB,EAAN,CAAf;;AAEA,UAAI,CAACO,QAAD,IAAa9B,OAAjB,EAA0B;AACxB8B,mBAAW,IAAI,IAAJ,CAASH,KAAKI,KAAL,CAAW9B,aAAa+B,OAAb,CAAqBT,EAArB,CAAX,CAAT,CAAX;AACD;;AAED,aAAOO,QAAP;AACD;;;;;;AAiBH;;;QACSvB,QAAAA","file":"index.map","sourceRoot":"../src/js","sourcesContent":["// Variables:\nlet cache = []\nlet persist = true\n\ntry {\n  localStorage.setItem('tdmnco-model-js', {})\n  localStorage.removeItem('tdmnco-model-js')\n} catch(error) {\n  console.warn('Model.js: localStorage not supported!', error)\n\n  persist = false\n}\n\n// Classes:\nclass Model {\n  constructor(data) {\n    this._created = new Date().toISOString()\n    this._data = data\n    this._updateHooks = []\n\n    for (let key of Object.keys(this._data)) {\n      Object.defineProperty(this, key, {\n        get: () => {\n          return this._data[key]\n        },\n\n        set: (value) => {\n          for (let hook of this._updateHooks) {\n            hook(key, this._data[key], value)\n          }\n\n          this._data[key] = value\n\n          return value\n        }\n      })\n    }\n  }\n\n  static get(id) {\n    id = (this.prototype.modelName || this.prototype.constructor.name) + '-' + id\n\n    let instance = cache[id]\n\n    if (!instance && persist) {\n      instance = new this(JSON.parse(localStorage.getItem(id)))\n    }\n\n    return instance\n  }\n\n  onUpdate(hook) {\n    this._updateHooks.push(hook)\n  }\n\n  save() {\n    let id = (this.modelName || this.constructor.name) + '-' + this.id\n\n    cache[id] = this\n\n    if (persist) {\n      localStorage.setItem(id, JSON.stringify(this._data))\n    }\n  }\n}\n\n// Exports:\nexport { Model }\n","// Exports:\nexport { Model } from './model'\n"]}